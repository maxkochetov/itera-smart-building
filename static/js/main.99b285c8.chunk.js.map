{"version":3,"sources":["constants.ts","utils.ts","room/RoomApi.service.ts","room/NoData.tsx","room/Details.tsx","room/Search.tsx","room/List.tsx","App.tsx","index.tsx"],"names":["API_URL","handleHttpErrors","response","ok","Error","statusText","getDateTimeUri","opts","dateFrom","dateTo","timeFrom","timeTo","concat","NoData","react_default","a","createElement","className","CFG","chartId","chartPieId","openedColor","closedColor","RoomDetails","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","xyChart","pieChart","dateAxis","rangesColors","PRESENT","color","NOT_PRESENT","create","Promise","all","fetchXyChartData","fetchPieChartData","fetchDoorStateChartData","then","_ref","_ref2","slicedToArray","xyResponse","pieResponse","doorStateResponse","createXyChart","createPieChart","renderRanges","catch","console","error","finally","setState","isLoading","update","_ref3","_ref4","setXyChartData","setPieChartData","preparePieChartData","datepickerChanged","field","value","datepicker","objectSpread","state","defineProperty","useTheme","am4themes_animated","Date","location","match","params","id","formatDate","setDate","getDate","toLocaleTimeString","charts","pie","xy","dispose","_this2","data","_ref5","axisRanges","clear","forEach","el","createRange","startDateTime","endDateTime","xyChartData","pieChartData","openTime","_ref6","closedTime","_this$splitTime","splitTime","_this$splitTime2","openedHours","openedMinutes","_this$splitTime3","_this$splitTime4","closedHours","closedMinutes","parseInt","amount","calcAmount","lighten","s","splitedOpen","split","_splitedOpen","url","fetch","res","json","err","fetchRoomTemperature","_ref7","_ref7$data","map","temperature","timestamp","fetchRoomStatistic","fetchDoorStateData","axis","from","to","range","endValue","axisFill","fill","fillOpacity","chartData","XYChart","cursor","XYCursor","xAxes","push","DateAxis","title","text","tooltipDateFormat","dateFormats","setKey","periodChangeDateFormats","startLocation","endLocation","yAxes","ValueAxis","series","LineSeries","dataFields","valueY","dateX","name","stroke","strokeWidth","tooltipText","scrollbarX","XYChartScrollbar","_ref8","PieChart","pieSeries","PieSeries","slices","template","propertyFields","category","date","chunk","arguments","length","undefined","toISOString","_this3","_this$state","react_router_dom","type","role","aria-label","onChange","_ref9","target","_ref10","_ref11","_ref12","onClick","style","width","height","backgroundColor","display","NoData_NoData","React","Component","RoomSearch","searchTerm","react","placeholder","RoomList","filterRooms","initialRooms","termLowerCased","toLowerCase","rooms","filter","r","indexOf","sessionStorage","getItem","setRooms","JSON","parse","cacheRooms","toConsumableArray","setItem","stringify","Search","room","key","App","basename","react_router","exact","path","component","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.99b285c8.chunk.js","sourcesContent":["// export const API_URL = 'http://localhost:1337';\nexport const API_URL = 'http://13.48.69.71:8081';\n","export const handleHttpErrors = (response: Response) => {\n  if (!response.ok) throw Error(response.statusText);\n  return response;\n};\n","import { API_URL } from '../constants';\nimport { IXyChartDoorStateData, IXyChartDataItem } from './Details.interface';\nimport { handleHttpErrors } from './../utils';\n\nexport interface IDoorStateDataResponse {\n  data: IXyChartDoorStateData[];\n  location: string;\n}\n\nexport interface ITemperatureResponse {\n  data: IXyChartDataItem[];\n  location: string;\n}\n\nexport interface IDoorStateStatisticResponse {\n  openTime: string;\n  closedTime: string;\n}\n\ninterface IFetchRoomStatisticOptions {\n  id: string;\n  dateFrom: string;\n  timeFrom: string;\n  dateTo: string;\n  timeTo: string;\n}\n\ntype IFetchRoomTemperatureOptions = IFetchRoomStatisticOptions;\ntype IFetchDoorStateDataOptions = IFetchRoomStatisticOptions;\ntype IDateTimeUriOptions = IFetchRoomStatisticOptions;\n\nexport function fetchRooms(): Promise<string[]> {\n  return fetch(`${API_URL}/rooms`)\n    .then(handleHttpErrors)\n    .then(res => res.json())\n    .catch(err => console.error('fetchRooms', err));\n}\n\nexport const fetchRoomTemperature = (opts: IFetchRoomTemperatureOptions): Promise<ITemperatureResponse> => {\n  const url = `${API_URL}/rooms/${opts.id}/temperatureData?${getDateTimeUri(opts)}`;\n\n  return fetch(url)\n    .then(handleHttpErrors)\n    .then(res => res.json())\n    .catch(err => console.error('fetchRoomTemperature', err));\n}\n\nexport const fetchRoomStatistic = (opts: IFetchRoomStatisticOptions): Promise<IDoorStateStatisticResponse> => {\n  const url = `${API_URL}/rooms/${opts.id}/doorStateStatistic?${getDateTimeUri(opts)}`;\n\n  return fetch(url)\n    .then(handleHttpErrors)\n    .then(res => res.json())\n    .catch(err => console.error('fetchRoomStatistic', err));\n}\n\nexport const fetchDoorStateData = (opts: IFetchDoorStateDataOptions): Promise<IDoorStateDataResponse> => {\n  const url = `${API_URL}/rooms/${opts.id}/doorStateData?${getDateTimeUri(opts)}`;\n\n  return fetch(url)\n    .then(handleHttpErrors)\n    .then(res => res.json())\n    .catch(err => console.error('fetchDoorStateData', err));\n}\n\nconst getDateTimeUri = (opts: IDateTimeUriOptions): string => {\n  const { dateFrom, dateTo } = opts;\n  let { timeFrom, timeTo } = opts;\n\n  // native <input type=\"time\"> trims '00:00:00' to '00:00', but BE requires a format with the seconds\n  if (timeFrom === '00:00') timeFrom = '00:00:00';\n  if (timeTo === '00:00') timeTo = '00:00:00';\n\n  return `startDateTime=${dateFrom}T${timeFrom}.000&endDateTime=${dateTo}T${timeTo}.000`;\n}\n","import React from 'react';\n\nexport const NoData = (): JSX.Element => <h3 className=\"text-center mt-5 mb-5 text-secondary\">No Data</h3>;\n","import React from 'react';\nimport { Link } from \"react-router-dom\";\nimport { useTheme, create, color, Color } from \"@amcharts/amcharts4/core\";\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\n\nimport {\n  XYChart, ValueAxis, XYCursor, XYChartScrollbar, PieChart, PieSeries, DateAxis, LineSeries, AxisRenderer\n} from \"@amcharts/amcharts4/charts\";\n\nimport {\n  RoomDetailsProps, RoomDetailsState, IXyChart, IXyChartDataItem, IPieChartItem, IXyChartDoorStateData\n} from './Details.interface';\n\nimport {\n  fetchRoomTemperature, fetchRoomStatistic, IDoorStateStatisticResponse, fetchDoorStateData, IDoorStateDataResponse\n} from './RoomApi.service';\n\nimport { NoData } from './NoData';\n\nconst CFG = {\n  chartId: 'js-chart-xy',\n  chartPieId: 'js-chart-pie',\n  openedColor: 'blue',\n  closedColor: 'red'\n}\n\nclass RoomDetails extends React.Component<RoomDetailsProps, RoomDetailsState> {\n  xyChart: IXyChart | undefined; // undefined because we can't render the element in constructor phase\n  pieChart: PieChart | undefined;\n  dateAxis: DateAxis<AxisRenderer> | undefined;\n\n  rangesColors: { [key in IXyChartDoorStateData['state']]: Color } = {\n    PRESENT: color(CFG.closedColor),\n    NOT_PRESENT: color(CFG.openedColor)\n  };\n\n  constructor(props: RoomDetailsProps) {\n    super(props);\n    useTheme(am4themes_animated);\n    const dateFrom = new Date();\n\n    this.state = {\n      isLoading: true,\n      location: props.match.params.id,\n      datepicker: {\n        dateFrom: this.formatDate(new Date(dateFrom.setDate(dateFrom.getDate() - 1))),\n        timeFrom: new Date().toLocaleTimeString(),\n        dateTo: this.formatDate(new Date()),\n        timeTo: new Date().toLocaleTimeString()\n      },\n      charts: {\n        pie: [],\n        xy: []\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.create();\n  }\n\n  componentWillUnmount() {\n    if (this.xyChart) this.xyChart.dispose();\n    if (this.pieChart) this.pieChart.dispose();\n  }\n\n  create = () => {\n    Promise.all([this.fetchXyChartData(), this.fetchPieChartData(), this.fetchDoorStateChartData()])\n      .then(([xyResponse, pieResponse, doorStateResponse]) => {\n        this.createXyChart(xyResponse);\n        this.createPieChart(pieResponse);\n        this.renderRanges(doorStateResponse);\n      })\n      .catch(console.error)\n      .finally(() => this.setState({ isLoading: false }));\n  }\n\n  update = () => {\n    Promise.all([this.fetchXyChartData(), this.fetchPieChartData(), this.fetchDoorStateChartData()])\n      .then(([xyResponse, pieResponse, doorStateResponse]) => {\n        this.setXyChartData(xyResponse);\n        this.setPieChartData(this.preparePieChartData(pieResponse));\n        this.renderRanges(doorStateResponse);\n      })\n      .catch(console.error);\n  }\n\n  renderRanges({data}: IDoorStateDataResponse) {\n    const { dateAxis } = this;\n    if (!dateAxis) return;\n\n    dateAxis.axisRanges.clear();\n\n    data.forEach((el: IXyChartDoorStateData) => {\n      this.createRange(dateAxis, new Date(el.startDateTime), new Date(el.endDateTime), this.rangesColors[el.state]);\n    });\n  }\n\n  setXyChartData(xyChartData: IXyChartDataItem[]) {\n    this.setState({\n      charts: { ...this.state.charts, xy: xyChartData }\n    });\n\n    if (this.xyChart) this.xyChart.data = xyChartData;\n  }\n\n  setPieChartData(pieChartData: IPieChartItem[]) {\n    this.setState({\n      charts: { ...this.state.charts, pie: pieChartData }\n    });\n\n    if (this.pieChart) this.pieChart.data = pieChartData;\n  }\n\n  preparePieChartData({openTime, closedTime}: IDoorStateStatisticResponse): IPieChartItem[] {\n    const [openedHours, openedMinutes] = this.splitTime(openTime);\n    const [closedHours, closedMinutes] = this.splitTime(closedTime);\n\n    const noData = parseInt(openTime) === 0 && parseInt(closedTime) === 0; // BE response \"00:00:00\"\n\n    return noData\n      ? []\n      : [\n        {state: 'Opened', amount: this.calcAmount(openedHours, openedMinutes), color: color(CFG.openedColor).lighten(0.65)},\n        {state: 'Closed', amount: this.calcAmount(closedHours, closedMinutes), color: color(CFG.closedColor).lighten(0.65)}\n      ];\n  }\n\n  splitTime(s: string): [string, string] {\n    const splitedOpen = s.split(':');\n    const [openHours, openMinutes] = splitedOpen; // ignoring seconds for now\n    return [openHours, openMinutes];\n  }\n\n  calcAmount(openedHours: string, openedMinutes: string): number {\n    return (parseInt(openedHours) * 60) + parseInt(openedMinutes);\n  }\n\n  fetchXyChartData(): Promise<IXyChartDataItem[]> {\n    return fetchRoomTemperature({ id: this.state.location, ...this.state.datepicker })\n      .then(({ data = [] }) => data.map((el: IXyChartDataItem) => ({\n        temperature: el.temperature,\n        timestamp: new Date(el.timestamp)\n      })));\n  }\n\n  fetchPieChartData(): Promise<IDoorStateStatisticResponse> {\n    return fetchRoomStatistic({ id: this.state.location, ...this.state.datepicker });\n  }\n\n  fetchDoorStateChartData(): Promise<IDoorStateDataResponse> {\n    return fetchDoorStateData({ id: this.state.location, ...this.state.datepicker });\n  }\n\n  createRange(axis: DateAxis<AxisRenderer>, from: Date, to: Date, color: Color) {\n    const range = axis.axisRanges.create();\n    (range as any).value = from;\n    (range as any).endValue = to;\n    range.axisFill.fill = color;\n    range.axisFill.fillOpacity = 0.3;\n  }\n\n  createXyChart(chartData: IXyChartDataItem[]) {\n    this.xyChart = create(CFG.chartId, XYChart);\n    this.xyChart.cursor = new XYCursor();\n    this.setXyChartData(chartData);\n\n    this.dateAxis = this.xyChart.xAxes.push(new DateAxis());\n    this.dateAxis.title.text = \"üïë Time\";\n    this.dateAxis.tooltipDateFormat = \"dd.MM\";\n    this.dateAxis.dateFormats.setKey(\"hour\", \"MMMM dt\");\n    this.dateAxis.periodChangeDateFormats.setKey(\"hour\", \"MMMM dt\");\n    this.dateAxis.startLocation = 1;\n    this.dateAxis.endLocation = 0;\n\n    const valueAxis = this.xyChart.yAxes.push(new ValueAxis());\n    valueAxis.title.text = \"üå° (¬∞C)\";\n\n    const series = this.xyChart.series.push(new LineSeries());\n    series.dataFields.valueY = \"temperature\";\n    series.dataFields.dateX = \"timestamp\";\n    series.name = \"Temperature\";\n    series.stroke = color('yellow').lighten(0.1);\n    series.fill = color('#efefef');\n    series.strokeWidth = 1;\n    // series.strokeOpacity = 0.8;\n    // series.fillOpacity = 0.5;\n    // series.tensionY = 0.97;\n    // series.tensionX = 0.97;\n    series.tooltipText = \"At {dateX.formatDate('HH:mm')} the temperature was {valueY}¬∞\";\n\n    const scrollbarX = new XYChartScrollbar(); // Add horizotal scrollbar with preview\n    scrollbarX.series.push(series);\n    this.xyChart.scrollbarX = scrollbarX;\n  }\n\n  createPieChart({ openTime, closedTime }: IDoorStateStatisticResponse) {\n    this.pieChart = create(CFG.chartPieId, PieChart);\n\n    const pieSeries = this.pieChart.series.push(new PieSeries());\n    pieSeries.slices.template.propertyFields.fill = \"color\";\n    pieSeries.slices.template.propertyFields.stroke = \"color\";\n    pieSeries.dataFields.value = \"amount\";\n    pieSeries.dataFields.category = \"state\";\n    pieSeries.slices.template.tooltipText = \"{category}: {value.value} minutes\";\n\n    this.setPieChartData(this.preparePieChartData({ openTime, closedTime }));\n  }\n\n  datepickerChanged = (field: keyof RoomDetailsState['datepicker'], value: string) => {\n    this.setState({\n      datepicker: {\n        ...this.state.datepicker,\n        [field]: value\n      }\n    });\n  }\n\n  formatDate(date: Date, chunk = 0): string {\n    return date.toISOString().split('T')[chunk];\n  }\n\n  render(): JSX.Element {\n    const { location, isLoading, datepicker, charts } = this.state;\n\n    return (\n      <div className=\"container\">\n        <div className=\"row mb-5\">\n          <div className=\"col-12\">\n            <div className=\"row mb-3 mt-3\">\n              <div className=\"col-3\">\n                <Link to=\"/\" className=\"text-decoration-none\">\n                  <button type=\"button\" className=\"btn btn-light alert btn-block\">\n                    <span role=\"img\" aria-label=\"go back\">‚Üê</span> select room\n                  </button>\n                </Link>\n              </div>\n              <div className=\"col-9\">\n                <div className=\"alert alert-success text-center\">\n                  {location}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"row\">\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Date From</label>\n                  <input\n                    type=\"date\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('dateFrom', value)}\n                    value={datepicker.dateFrom} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Time From</label>\n                  <input\n                    type=\"time\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('timeFrom', value)}\n                    value={datepicker.timeFrom} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Date To</label>\n                  <input\n                    type=\"date\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('dateTo', value)}\n                    value={datepicker.dateTo} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Time To</label>\n                  <input\n                    type=\"time\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('timeTo', value)}\n                    value={datepicker.timeTo} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <label>&nbsp;</label>\n                <button onClick={this.update} type=\"button\" className=\"form-control btn btn-outline-primary\">\n                  <span role=\"img\" aria-label=\"go back\">üîÑ</span>\n                </button>\n              </div>\n            </div>\n\n            {/* TODO: info message about timings */}\n\n            <div className=\"alert alert-warning d-flex justify-content-around align-items-center\">\n              <div className=\"d-flex align-items-center\">\n                <div className=\"rounded-circle mr-2\" style={{ width: '1rem', height: '1rem', backgroundColor: CFG.openedColor }}></div>\n                <div>Door Opened</div>\n              </div>\n              <div>Temperature</div>\n              <div className=\"d-flex align-items-center\">\n                <div className=\"rounded-circle mr-2\" style={{ width: '1rem', height: '1rem', backgroundColor: CFG.closedColor }}></div>\n                <div>Door Closed</div>\n              </div>\n            </div>\n\n            <div id={CFG.chartId} style={{\n              width: \"100%\",\n              height: \"25rem\",\n              display: charts.xy.length === 0 ? 'none' : 'block'\n            }}>\n            </div>\n\n            {(charts.xy.length === 0 && !isLoading) && <NoData />}\n\n            <div className=\"alert alert-secondary text-center\">Proximity</div>\n            <div id={CFG.chartPieId} className=\"mt-5\" style={{\n              width: \"100%\",\n              height: \"10rem\",\n              display: charts.pie.length === 0 ? 'none' : 'block'\n            }}>\n            </div>\n\n            {(charts.pie.length === 0 && !isLoading) && <NoData />}\n\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n\nexport default RoomDetails;\n","import * as React from 'react';\n\nexport interface RoomSearchProps {\n  onChange: (searchTerm: string) => void;\n}\n\nexport interface RoomSearchState {\n  searchTerm: string;\n}\n\nclass RoomSearch extends React.Component<RoomSearchProps, RoomSearchState> {\n  constructor(props: RoomSearchProps) {\n    super(props);\n\n    this.state = {\n      searchTerm: ''\n    };\n  }\n\n  render(): JSX.Element {\n    return (\n      <div className=\"form-group\">\n        <input\n          type=\"text\"\n          className=\"form-control\"\n          placeholder=\"Search for a room..\"\n          onChange={ ({target: {value: searchTerm}}) => this.props.onChange(searchTerm) }/>\n      </div>\n    );\n  }\n}\n\nexport default RoomSearch;\n","import * as React from 'react';\n\nimport { Link } from \"react-router-dom\";\nimport { fetchRooms } from './RoomApi.service';\nimport RoomSearch from './Search';\n\ninterface RoomListProps {}\n\ninterface RoomListState {\n  initialRooms: string[];\n  rooms: string[];\n}\n\nclass RoomList extends React.Component<RoomListProps, RoomListState> {\n  constructor(props: RoomListProps) {\n    super(props);\n\n    this.state = {\n      initialRooms: [],\n      rooms: []\n    };\n  }\n\n  componentWillMount() {\n    const rooms = sessionStorage.getItem('rooms');\n\n    if (rooms) {\n      this.setRooms(JSON.parse(rooms));\n    } else {\n      fetchRooms().then(initialRooms => {\n        this.setRooms(initialRooms);\n        this.cacheRooms(initialRooms);\n      });\n    }\n  }\n\n  setRooms(initialRooms: string[]) {\n    this.setState({\n      initialRooms,\n      rooms: [...initialRooms]\n    });\n  }\n\n  cacheRooms(initialRooms: string[]) {\n    sessionStorage.setItem('rooms', JSON.stringify(initialRooms));\n  }\n\n  filterRooms = (searchTerm: string) => {\n    const { initialRooms } = this.state;\n    const termLowerCased = searchTerm.toLowerCase();\n\n    const rooms = searchTerm\n      ? initialRooms.filter(r => r.toLowerCase().indexOf(termLowerCased) > -1)\n      : initialRooms;\n\n    this.setState({rooms});\n  }\n\n  render(): JSX.Element {\n    return (\n      <div className=\"container mt-4\">\n        <div className=\"row\">\n          <div className=\"col-6 offset-3\">\n            <RoomSearch onChange={this.filterRooms} />\n          </div>\n        </div>\n\n        <div className=\"row\">\n          <div className=\"col-6 offset-3\">\n            <div className=\"list-group mb-5\">\n            {this.state.rooms.map((room: string) =>\n              <Link\n                to={`/room/${room}`}\n                key={room}\n                className=\"list-group-item list-group-item-action\">\n                {room}\n              </Link>\n            )}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default RoomList;\n","import React from 'react';\n\nimport './App.css';\n\nimport RoomDetails from './room/Details';\nimport RoomList from './room/List';\n\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\n\nfunction App() {\n  return (\n    <Router basename={process.env.NODE_ENV === 'development' ? '' : '/itera-smart-building/'}>\n      <Route exact path=\"/\" component={RoomList} />\n      <Route path=\"/room/:id\" component={RoomDetails} />\n    </Router>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}