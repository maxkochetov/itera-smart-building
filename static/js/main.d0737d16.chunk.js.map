{"version":3,"sources":["constants.ts","utils.ts","room/RoomApi.service.ts","room/NoData.tsx","room/Details.tsx","room/Search.tsx","room/List.tsx","App.tsx","index.tsx"],"names":["API_URL","handleHttpErrors","response","ok","console","error","statusText","Error","getDateTimeUri","opts","dateFrom","dateTo","timeFrom","timeTo","concat","NoData","react_default","a","createElement","className","CFG","chartId","chartPieId","openedColor","closedColor","RoomDetails","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","xyChart","pieChart","dateAxis","rangesColors","PRESENT","color","NOT_PRESENT","create","Promise","all","fetchXyChartData","fetchPieChartData","fetchDoorStateChartData","then","_ref","_ref2","slicedToArray","xyResponse","pieResponse","doorStateResponse","createXyChart","createPieChart","renderRanges","catch","finally","setState","isLoading","update","_ref3","_ref4","setXyChartData","setPieChartData","preparePieChartData","datepickerChanged","field","value","datepicker","objectSpread","state","defineProperty","useTheme","am4themes_animated","Date","location","match","params","id","formatDate","setDate","getDate","toLocaleTimeString","charts","pie","xy","dispose","_this2","data","_ref5","axisRanges","clear","forEach","el","createRange","startDateTime","endDateTime","xyChartData","pieChartData","openTime","_ref6","closedTime","_this$splitTime","splitTime","_this$splitTime2","openedHours","openedMinutes","_this$splitTime3","_this$splitTime4","closedHours","closedMinutes","parseInt","amount","calcAmount","lighten","s","splitedOpen","split","_splitedOpen","url","fetch","res","json","fetchRoomTemperature","_ref7","_ref7$data","map","temperature","timestamp","fetchRoomStatistic","fetchDoorStateData","axis","from","to","range","endValue","axisFill","fill","fillOpacity","chartData","XYChart","cursor","XYCursor","xAxes","push","DateAxis","title","text","tooltipDateFormat","dateFormats","setKey","periodChangeDateFormats","startLocation","endLocation","yAxes","ValueAxis","series","LineSeries","dataFields","valueY","dateX","name","stroke","strokeWidth","tooltipText","scrollbarX","XYChartScrollbar","_ref8","PieChart","pieSeries","PieSeries","slices","template","propertyFields","category","date","chunk","arguments","length","undefined","toISOString","_this3","_this$state","react_router_dom","type","role","aria-label","onChange","_ref9","target","_ref10","_ref11","_ref12","onClick","style","width","height","backgroundColor","display","NoData_NoData","React","Component","RoomSearch","_useState","useState","_useState2","searchTerm","setSearchTerm","searchTermChanged","placeholder","RoomList","filterRooms","initialRooms","termLowerCased","toLowerCase","rooms","filter","r","indexOf","sessionStorage","getItem","setRooms","JSON","parse","cacheRooms","toConsumableArray","setItem","stringify","react","Search_RoomSearch","room","key","App","basename","react_router","exact","path","component","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.d0737d16.chunk.js","sourcesContent":["// export const API_URL = 'http://localhost:1337';\nexport const API_URL = 'http://13.48.69.71:8081';\n// export const API_URL = 'https://13.48.69.71:80';\n// export const API_URL = 'https://13.48.69.71';\n","export function handleHttpErrors(response: Response) {\n  if (!response.ok) {\n    console.error(response.statusText);\n    throw new Error(response.statusText);\n  }\n  return response;\n};\n","import { API_URL } from '../constants';\nimport { IXyChartDoorStateData, IXyChartDataItem } from './Details.interface';\nimport { handleHttpErrors } from './../utils';\n\nexport interface IDoorStateDataResponse {\n  data: IXyChartDoorStateData[];\n  location: string;\n}\n\nexport interface ITemperatureResponse {\n  data: IXyChartDataItem[];\n  location: string;\n}\n\nexport interface IDoorStateStatisticResponse {\n  openTime: string;\n  closedTime: string;\n}\n\ninterface IFetchRoomStatisticOptions {\n  id: string;\n  dateFrom: string;\n  timeFrom: string;\n  dateTo: string;\n  timeTo: string;\n}\n\ntype IFetchRoomTemperatureOptions = IFetchRoomStatisticOptions;\ntype IFetchDoorStateDataOptions = IFetchRoomStatisticOptions;\ntype IDateTimeUriOptions = IFetchRoomStatisticOptions;\n\nexport const fetchRooms = (): Promise<string[]> => {\n  return fetch(`${API_URL}/rooms`)\n    .then(handleHttpErrors)\n    .then(res => res.json());\n}\n\nexport const fetchRoomTemperature = (opts: IFetchRoomTemperatureOptions): Promise<ITemperatureResponse> => {\n  const url = `${API_URL}/rooms/${opts.id}/temperatureData?${getDateTimeUri(opts)}`;\n\n  return fetch(url)\n    .then(handleHttpErrors)\n    .then(res => res.json());\n}\n\nexport const fetchRoomStatistic = (opts: IFetchRoomStatisticOptions): Promise<IDoorStateStatisticResponse> => {\n  const url = `${API_URL}/rooms/${opts.id}/doorStateStatistic?${getDateTimeUri(opts)}`;\n\n  return fetch(url)\n    .then(handleHttpErrors)\n    .then(res => res.json());\n}\n\nexport const fetchDoorStateData = (opts: IFetchDoorStateDataOptions): Promise<IDoorStateDataResponse> => {\n  const url = `${API_URL}/rooms/${opts.id}/doorStateData?${getDateTimeUri(opts)}`;\n\n  return fetch(url)\n    .then(handleHttpErrors)\n    .then(res => res.json());\n}\n\nconst getDateTimeUri = (opts: IDateTimeUriOptions): string => {\n  const { dateFrom, dateTo } = opts;\n  let { timeFrom, timeTo } = opts;\n\n  // native <input type=\"time\"> trims '00:00:00' to '00:00', but BE requires a format with the seconds\n  if (timeFrom === '00:00') timeFrom = '00:00:00';\n  if (timeTo === '00:00') timeTo = '00:00:00';\n\n  return `startDateTime=${dateFrom}T${timeFrom}.000&endDateTime=${dateTo}T${timeTo}.000`;\n}\n","import React from 'react';\n\nexport const NoData = (): JSX.Element => <h3 className=\"text-center mt-5 mb-5 text-secondary\">No Data</h3>;\n","import React from 'react';\nimport { Link } from \"react-router-dom\";\nimport { useTheme, create, color, Color } from \"@amcharts/amcharts4/core\";\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\n\nimport {\n  XYChart, ValueAxis, XYCursor, XYChartScrollbar, PieChart, PieSeries, DateAxis, LineSeries, AxisRenderer\n} from \"@amcharts/amcharts4/charts\";\n\nimport {\n  RoomDetailsProps, RoomDetailsState, IXyChart, IXyChartDataItem, IPieChartItem, IXyChartDoorStateData\n} from './Details.interface';\n\nimport {\n  fetchRoomTemperature, fetchRoomStatistic, IDoorStateStatisticResponse, fetchDoorStateData, IDoorStateDataResponse\n} from './RoomApi.service';\n\nimport { NoData } from './NoData';\n\nconst CFG = {\n  chartId: 'js-chart-xy',\n  chartPieId: 'js-chart-pie',\n  openedColor: 'blue',\n  closedColor: 'red'\n}\n\nclass RoomDetails extends React.Component<RoomDetailsProps, RoomDetailsState> {\n  xyChart: IXyChart | undefined; // undefined because we can't render the element in constructor phase\n  pieChart: PieChart | undefined;\n  dateAxis: DateAxis<AxisRenderer> | undefined;\n\n  rangesColors: { [key in IXyChartDoorStateData['state']]: Color } = {\n    PRESENT: color(CFG.closedColor),\n    NOT_PRESENT: color(CFG.openedColor)\n  };\n\n  constructor(props: RoomDetailsProps) {\n    super(props);\n    useTheme(am4themes_animated);\n    const dateFrom = new Date();\n\n    this.state = {\n      isLoading: true,\n      location: props.match.params.id,\n      datepicker: {\n        dateFrom: this.formatDate(new Date(dateFrom.setDate(dateFrom.getDate() - 1))),\n        timeFrom: new Date().toLocaleTimeString(),\n        dateTo: this.formatDate(new Date()),\n        timeTo: new Date().toLocaleTimeString()\n      },\n      charts: {\n        pie: [],\n        xy: []\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.create();\n  }\n\n  componentWillUnmount() {\n    if (this.xyChart) this.xyChart.dispose();\n    if (this.pieChart) this.pieChart.dispose();\n  }\n\n  create = () => {\n    Promise.all([this.fetchXyChartData(), this.fetchPieChartData(), this.fetchDoorStateChartData()])\n      .then(([xyResponse, pieResponse, doorStateResponse]) => {\n        this.createXyChart(xyResponse);\n        this.createPieChart(pieResponse);\n        this.renderRanges(doorStateResponse);\n      })\n      .catch(console.error)\n      .finally(() => this.setState({ isLoading: false }));\n  }\n\n  update = () => {\n    Promise.all([this.fetchXyChartData(), this.fetchPieChartData(), this.fetchDoorStateChartData()])\n      .then(([xyResponse, pieResponse, doorStateResponse]) => {\n        this.setXyChartData(xyResponse);\n        this.setPieChartData(this.preparePieChartData(pieResponse));\n        this.renderRanges(doorStateResponse);\n      })\n      .catch(console.error);\n  }\n\n  renderRanges({data}: IDoorStateDataResponse) {\n    const { dateAxis } = this;\n    if (!dateAxis) return;\n\n    dateAxis.axisRanges.clear();\n\n    data.forEach((el: IXyChartDoorStateData) => {\n      this.createRange(dateAxis, new Date(el.startDateTime), new Date(el.endDateTime), this.rangesColors[el.state]);\n    });\n  }\n\n  setXyChartData(xyChartData: IXyChartDataItem[]) {\n    this.setState({\n      charts: { ...this.state.charts, xy: xyChartData }\n    });\n\n    if (this.xyChart) this.xyChart.data = xyChartData;\n  }\n\n  setPieChartData(pieChartData: IPieChartItem[]) {\n    this.setState({\n      charts: { ...this.state.charts, pie: pieChartData }\n    });\n\n    if (this.pieChart) this.pieChart.data = pieChartData;\n  }\n\n  preparePieChartData({openTime, closedTime}: IDoorStateStatisticResponse): IPieChartItem[] {\n    const [openedHours, openedMinutes] = this.splitTime(openTime);\n    const [closedHours, closedMinutes] = this.splitTime(closedTime);\n\n    const noData = parseInt(openTime) === 0 && parseInt(closedTime) === 0; // BE response \"00:00:00\"\n\n    return noData\n      ? []\n      : [\n        {state: 'Opened', amount: this.calcAmount(openedHours, openedMinutes), color: color(CFG.openedColor).lighten(0.65)},\n        {state: 'Closed', amount: this.calcAmount(closedHours, closedMinutes), color: color(CFG.closedColor).lighten(0.65)}\n      ];\n  }\n\n  splitTime(s: string): [string, string] {\n    const splitedOpen = s.split(':');\n    const [openHours, openMinutes] = splitedOpen; // ignoring seconds for now\n    return [openHours, openMinutes];\n  }\n\n  calcAmount(openedHours: string, openedMinutes: string): number {\n    return (parseInt(openedHours) * 60) + parseInt(openedMinutes);\n  }\n\n  fetchXyChartData(): Promise<IXyChartDataItem[]> {\n    return fetchRoomTemperature({ id: this.state.location, ...this.state.datepicker })\n      .then(({ data = [] }) => data.map((el: IXyChartDataItem) => ({\n        temperature: el.temperature,\n        timestamp: new Date(el.timestamp)\n      })));\n  }\n\n  fetchPieChartData(): Promise<IDoorStateStatisticResponse> {\n    return fetchRoomStatistic({ id: this.state.location, ...this.state.datepicker });\n  }\n\n  fetchDoorStateChartData(): Promise<IDoorStateDataResponse> {\n    return fetchDoorStateData({ id: this.state.location, ...this.state.datepicker });\n  }\n\n  createRange(axis: DateAxis<AxisRenderer>, from: Date, to: Date, color: Color) {\n    const range = axis.axisRanges.create();\n    (range as any).value = from;\n    (range as any).endValue = to;\n    range.axisFill.fill = color;\n    range.axisFill.fillOpacity = 0.3;\n  }\n\n  createXyChart(chartData: IXyChartDataItem[]) {\n    this.xyChart = create(CFG.chartId, XYChart);\n    this.xyChart.cursor = new XYCursor();\n    this.setXyChartData(chartData);\n\n    this.dateAxis = this.xyChart.xAxes.push(new DateAxis());\n    this.dateAxis.title.text = \"üïë Time\";\n    this.dateAxis.tooltipDateFormat = \"dd.MM\";\n    this.dateAxis.dateFormats.setKey(\"hour\", \"MMMM dt\");\n    this.dateAxis.periodChangeDateFormats.setKey(\"hour\", \"MMMM dt\");\n    this.dateAxis.startLocation = 1;\n    this.dateAxis.endLocation = 0;\n\n    const valueAxis = this.xyChart.yAxes.push(new ValueAxis());\n    valueAxis.title.text = \"üå° (¬∞C)\";\n\n    const series = this.xyChart.series.push(new LineSeries());\n    series.dataFields.valueY = \"temperature\";\n    series.dataFields.dateX = \"timestamp\";\n    series.name = \"Temperature\";\n    series.stroke = color('yellow').lighten(0.1);\n    series.fill = color('#efefef');\n    series.strokeWidth = 1;\n    // series.strokeOpacity = 0.8;\n    // series.fillOpacity = 0.5;\n    // series.tensionY = 0.97;\n    // series.tensionX = 0.97;\n    series.tooltipText = \"At {dateX.formatDate('HH:mm')} the temperature was {valueY}¬∞\";\n\n    const scrollbarX = new XYChartScrollbar(); // Add horizotal scrollbar with preview\n    scrollbarX.series.push(series);\n    this.xyChart.scrollbarX = scrollbarX;\n  }\n\n  createPieChart({ openTime, closedTime }: IDoorStateStatisticResponse) {\n    this.pieChart = create(CFG.chartPieId, PieChart);\n\n    const pieSeries = this.pieChart.series.push(new PieSeries());\n    pieSeries.slices.template.propertyFields.fill = \"color\";\n    pieSeries.slices.template.propertyFields.stroke = \"color\";\n    pieSeries.dataFields.value = \"amount\";\n    pieSeries.dataFields.category = \"state\";\n    pieSeries.slices.template.tooltipText = \"{category}: {value.value} minutes\";\n\n    this.setPieChartData(this.preparePieChartData({ openTime, closedTime }));\n  }\n\n  datepickerChanged = (field: keyof RoomDetailsState['datepicker'], value: string) => {\n    this.setState({\n      datepicker: {\n        ...this.state.datepicker,\n        [field]: value\n      }\n    });\n  }\n\n  formatDate(date: Date, chunk: 0 | 1 = 0): string {\n    return date.toISOString().split('T')[chunk];\n  }\n\n  render(): JSX.Element {\n    const { location, isLoading, datepicker, charts } = this.state;\n\n    return (\n      <div className=\"container\">\n        <div className=\"row mb-5\">\n          <div className=\"col-12\">\n            <div className=\"row mb-3 mt-3\">\n              <div className=\"col-3\">\n                <Link to=\"/\" className=\"text-decoration-none\">\n                  <button type=\"button\" className=\"btn btn-light alert btn-block\">\n                    <span role=\"img\" aria-label=\"go back\">‚Üê</span> select room\n                  </button>\n                </Link>\n              </div>\n              <div className=\"col-9\">\n                <div className=\"alert alert-success text-center\">\n                  {location}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"row\">\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Date From</label>\n                  <input\n                    type=\"date\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('dateFrom', value)}\n                    value={datepicker.dateFrom} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Time From</label>\n                  <input\n                    type=\"time\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('timeFrom', value)}\n                    value={datepicker.timeFrom} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Date To</label>\n                  <input\n                    type=\"date\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('dateTo', value)}\n                    value={datepicker.dateTo} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Time To</label>\n                  <input\n                    type=\"time\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('timeTo', value)}\n                    value={datepicker.timeTo} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <label>&nbsp;</label>\n                <button onClick={this.update} type=\"button\" className=\"form-control btn btn-outline-primary\">\n                  <span role=\"img\" aria-label=\"go back\">üîÑ</span>\n                </button>\n              </div>\n            </div>\n\n            {/* TODO: info message about timings */}\n\n            <div className=\"alert alert-warning d-flex justify-content-around align-items-center\">\n              <div className=\"d-flex align-items-center\">\n                <div className=\"rounded-circle mr-2\" style={{ width: '1rem', height: '1rem', backgroundColor: CFG.openedColor }}></div>\n                <div>Door Opened</div>\n              </div>\n              <div>Temperature</div>\n              <div className=\"d-flex align-items-center\">\n                <div className=\"rounded-circle mr-2\" style={{ width: '1rem', height: '1rem', backgroundColor: CFG.closedColor }}></div>\n                <div>Door Closed</div>\n              </div>\n            </div>\n\n            <div id={CFG.chartId} style={{\n              width: \"100%\",\n              height: \"25rem\",\n              display: charts.xy.length === 0 ? 'none' : 'block'\n            }}>\n            </div>\n\n            {(charts.xy.length === 0 && !isLoading) && <NoData />}\n\n            <div className=\"alert alert-secondary text-center\">Proximity</div>\n            <div id={CFG.chartPieId} className=\"mt-5\" style={{\n              width: \"100%\",\n              height: \"10rem\",\n              display: charts.pie.length === 0 ? 'none' : 'block'\n            }}>\n            </div>\n\n            {(charts.pie.length === 0 && !isLoading) && <NoData />}\n\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n\nexport default RoomDetails;\n","import React, { useState } from 'react';\n\ninterface RoomSearchProps {\n  onChange: (searchTerm: string) => void;\n}\n\nexport const RoomSearch = ({onChange}: RoomSearchProps): JSX.Element => {\n  const [searchTerm, setSearchTerm] = useState<string>('');\n\n  const searchTermChanged = (searchTerm: string) => {\n    setSearchTerm(searchTerm);\n    onChange(searchTerm);\n  }\n\n  return (\n    <div className=\"form-group\">\n      <input\n        type=\"text\"\n        className=\"form-control\"\n        value={searchTerm}\n        placeholder=\"Search for a room..\"\n        onChange={( {target: {value: searchTerm} }) => searchTermChanged(searchTerm) } />\n    </div>\n  );\n}\n","import * as React from 'react';\n\nimport { Link } from \"react-router-dom\";\nimport { fetchRooms } from './RoomApi.service';\nimport { RoomSearch } from './Search';\n\ninterface RoomListProps {}\n\ninterface RoomListState {\n  initialRooms: string[];\n  rooms: string[];\n}\n\nclass RoomList extends React.Component<RoomListProps, RoomListState> {\n  constructor(props: RoomListProps) {\n    super(props);\n\n    this.state = {\n      initialRooms: [],\n      rooms: []\n    };\n  }\n\n  componentWillMount() {\n    const rooms = sessionStorage.getItem('rooms');\n\n    if (rooms) {\n      this.setRooms(JSON.parse(rooms));\n    } else {\n      fetchRooms().then(initialRooms => {\n        this.setRooms(initialRooms);\n        this.cacheRooms(initialRooms);\n      });\n    }\n  }\n\n  setRooms(initialRooms: string[]) {\n    this.setState({\n      initialRooms,\n      rooms: [...initialRooms]\n    });\n  }\n\n  cacheRooms(initialRooms: string[]) {\n    sessionStorage.setItem('rooms', JSON.stringify(initialRooms));\n  }\n\n  filterRooms = (searchTerm: string) => {\n    const { initialRooms } = this.state;\n    const termLowerCased = searchTerm.toLowerCase();\n\n    const rooms = searchTerm\n      ? initialRooms.filter(r => r.toLowerCase().indexOf(termLowerCased) > -1)\n      : initialRooms;\n\n    this.setState({rooms});\n  }\n\n  render(): JSX.Element {\n    return (\n      <div className=\"container mt-4\">\n        <div className=\"row\">\n          <div className=\"col-6 offset-3\">\n            <RoomSearch onChange={this.filterRooms} />\n          </div>\n        </div>\n\n        <div className=\"row\">\n          <div className=\"col-6 offset-3\">\n            <div className=\"list-group mb-5\">\n            {this.state.rooms.map((room: string) =>\n              <Link\n                to={`/room/${room}`}\n                key={room}\n                className=\"list-group-item list-group-item-action\">\n                {room}\n              </Link>\n            )}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default RoomList;\n","import React from 'react';\n\nimport './App.css';\n\nimport RoomDetails from './room/Details';\nimport RoomList from './room/List';\n\nimport { HashRouter as Router, Route } from \"react-router-dom\";\n\nfunction App() {\n  return (\n    // basename={process.env.NODE_ENV === 'development' ? '' : '/itera-smart-building/'}\n    <Router basename={'/itera-smart-building/'}>\n      <Route exact path=\"/\" component={RoomList} />\n      <Route path=\"/room/:id\" component={RoomDetails} />\n    </Router>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}