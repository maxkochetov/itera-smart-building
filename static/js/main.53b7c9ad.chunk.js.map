{"version":3,"sources":["constants.ts","utils.ts","room/RoomApi.service.ts","room/NoData.tsx","room/Details.tsx","room/Search.tsx","room/List.tsx","App.tsx","index.tsx"],"names":["API_URL","handleHttpErrors","response","ok","console","error","statusText","Error","getDateTimeUri","opts","dateFrom","dateTo","timeFrom","timeTo","concat","NoData","react_default","a","createElement","className","CFG","chartId","chartPieId","openedColor","closedColor","RoomDetails","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","xyChart","pieChart","dateAxis","rangesColors","PRESENT","color","NOT_PRESENT","create","Promise","all","fetchXyChartData","fetchPieChartData","fetchDoorStateChartData","then","_ref","_ref2","slicedToArray","xyResponse","pieResponse","doorStateResponse","createXyChart","createPieChart","renderRanges","catch","finally","setState","isLoading","update","_ref3","_ref4","setXyChartData","setPieChartData","preparePieChartData","datepickerChanged","field","value","datepicker","objectSpread","state","defineProperty","useTheme","am4themes_animated","currentDate","Date","formattedTime","toTimeString","split","location","match","params","id","formatDate","setDate","getDate","charts","pie","xy","dispose","_this2","data","_ref5","axisRanges","clear","forEach","el","createRange","startDateTime","endDateTime","xyChartData","pieChartData","openTime","_ref6","closedTime","_this$splitTime","splitTime","_this$splitTime2","openedHours","openedMinutes","_this$splitTime3","_this$splitTime4","closedHours","closedMinutes","parseInt","amount","calcAmount","lighten","s","splitedOpen","_splitedOpen","url","fetch","res","json","fetchRoomTemperature","_ref7","_ref7$data","map","temperature","timestamp","fetchRoomStatistic","fetchDoorStateData","axis","from","to","range","endValue","axisFill","fill","fillOpacity","chartData","XYChart","cursor","XYCursor","xAxes","push","DateAxis","title","text","tooltipDateFormat","dateFormats","setKey","periodChangeDateFormats","startLocation","endLocation","yAxes","ValueAxis","series","LineSeries","dataFields","valueY","dateX","name","stroke","strokeWidth","tooltipText","scrollbarX","XYChartScrollbar","_ref8","PieChart","pieSeries","PieSeries","slices","template","propertyFields","category","date","chunk","arguments","length","undefined","toISOString","_this3","_this$state","react_router_dom","type","role","aria-label","onChange","_ref9","target","_ref10","_ref11","_ref12","onClick","style","width","height","backgroundColor","display","NoData_NoData","React","Component","RoomSearch","_useState","useState","_useState2","searchTerm","setSearchTerm","searchTermChanged","placeholder","RoomList","filterRooms","initialRooms","termLowerCased","toLowerCase","rooms","filter","r","indexOf","sessionStorage","getItem","setRooms","JSON","parse","cacheRooms","toConsumableArray","setItem","stringify","react","Search_RoomSearch","room","key","App","basename","react_router","exact","path","component","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.53b7c9ad.chunk.js","sourcesContent":["// export const API_URL = 'http://localhost:1337';\n// export const API_URL = 'https://13.48.69.71:443';\nexport const API_URL = 'http://13.48.69.71';\n// export const API_URL = 'https://13.48.69.71:80';\n// export const API_URL = 'https://13.48.69.71';\n","export function handleHttpErrors(response: Response) {\n  if (!response.ok) {\n    console.error(response.statusText);\n    throw new Error(response.statusText);\n  }\n  return response;\n};\n","import { API_URL } from '../constants';\nimport { IXyChartDoorStateData, IXyChartDataItem } from './Details.interface';\nimport { handleHttpErrors } from './../utils';\n\nexport interface IDoorStateDataResponse {\n  data: IXyChartDoorStateData[];\n  location: string;\n}\n\nexport interface ITemperatureResponse {\n  data: IXyChartDataItem[];\n  location: string;\n}\n\nexport interface IDoorStateStatisticResponse {\n  openTime: string;\n  closedTime: string;\n}\n\ninterface IFetchRoomStatisticOptions {\n  id: string;\n  dateFrom: string;\n  timeFrom: string;\n  dateTo: string;\n  timeTo: string;\n}\n\ntype IFetchRoomTemperatureOptions = IFetchRoomStatisticOptions;\ntype IFetchDoorStateDataOptions = IFetchRoomStatisticOptions;\ntype IDateTimeUriOptions = IFetchRoomStatisticOptions;\n\nexport const fetchRooms = (): Promise<string[]> => {\n  return fetch(`${API_URL}/rooms`)\n    .then(handleHttpErrors)\n    .then(res => res.json());\n}\n\nexport const fetchRoomTemperature = (opts: IFetchRoomTemperatureOptions): Promise<ITemperatureResponse> => {\n  const url = `${API_URL}/rooms/${opts.id}/temperatureData?${getDateTimeUri(opts)}`;\n\n  return fetch(url)\n    .then(handleHttpErrors)\n    .then(res => res.json());\n}\n\nexport const fetchRoomStatistic = (opts: IFetchRoomStatisticOptions): Promise<IDoorStateStatisticResponse> => {\n  const url = `${API_URL}/rooms/${opts.id}/doorStateStatistic?${getDateTimeUri(opts)}`;\n\n  return fetch(url)\n    .then(handleHttpErrors)\n    .then(res => res.json());\n}\n\nexport const fetchDoorStateData = (opts: IFetchDoorStateDataOptions): Promise<IDoorStateDataResponse> => {\n  const url = `${API_URL}/rooms/${opts.id}/doorStateData?${getDateTimeUri(opts)}`;\n\n  return fetch(url)\n    .then(handleHttpErrors)\n    .then(res => res.json());\n}\n\nconst getDateTimeUri = (opts: IDateTimeUriOptions): string => {\n  const { dateFrom, dateTo } = opts;\n  let { timeFrom, timeTo } = opts;\n\n  // native <input type=\"time\"> trims '00:00:00' to '00:00', but BE requires a format with the seconds\n  if (timeFrom === '00:00') timeFrom = '00:00:00';\n  if (timeTo === '00:00') timeTo = '00:00:00';\n\n  return `startDateTime=${dateFrom}T${timeFrom}.000&endDateTime=${dateTo}T${timeTo}.000`;\n}\n","import React from 'react';\n\nexport const NoData = (): JSX.Element => <h3 className=\"text-center mt-5 mb-5 text-secondary\">No Data</h3>;\n","import React from 'react';\nimport { Link } from \"react-router-dom\";\nimport { useTheme, create, color, Color } from \"@amcharts/amcharts4/core\";\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\n\nimport {\n  XYChart, ValueAxis, XYCursor, XYChartScrollbar, PieChart, PieSeries, DateAxis, LineSeries, AxisRenderer\n} from \"@amcharts/amcharts4/charts\";\n\nimport {\n  RoomDetailsProps, RoomDetailsState, IXyChart, IXyChartDataItem, IPieChartItem, IXyChartDoorStateData\n} from './Details.interface';\n\nimport {\n  fetchRoomTemperature, fetchRoomStatistic, IDoorStateStatisticResponse, fetchDoorStateData, IDoorStateDataResponse\n} from './RoomApi.service';\n\nimport { NoData } from './NoData';\n\nconst CFG = {\n  chartId: 'js-chart-xy',\n  chartPieId: 'js-chart-pie',\n  openedColor: 'blue',\n  closedColor: 'red'\n}\n\nclass RoomDetails extends React.Component<RoomDetailsProps, RoomDetailsState> {\n  xyChart: IXyChart | undefined; // undefined because we can't render the element in constructor phase\n  pieChart: PieChart | undefined;\n  dateAxis: DateAxis<AxisRenderer> | undefined;\n\n  rangesColors: { [key in IXyChartDoorStateData['state']]: Color } = {\n    PRESENT: color(CFG.closedColor),\n    NOT_PRESENT: color(CFG.openedColor)\n  };\n\n  constructor(props: RoomDetailsProps) {\n    super(props);\n    useTheme(am4themes_animated);\n    const currentDate = new Date();\n    const formattedTime = new Date().toTimeString().split(' ')[0];\n\n    this.state = {\n      isLoading: true,\n      location: props.match.params.id,\n      datepicker: {\n        dateFrom: this.formatDate(new Date(currentDate.setDate(currentDate.getDate() - 1))),\n        timeFrom: formattedTime,\n        dateTo: this.formatDate(new Date()),\n        timeTo: formattedTime\n      },\n      charts: {\n        pie: [],\n        xy: []\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.create();\n  }\n\n  componentWillUnmount() {\n    if (this.xyChart) this.xyChart.dispose();\n    if (this.pieChart) this.pieChart.dispose();\n  }\n\n  create = () => {\n    Promise.all([this.fetchXyChartData(), this.fetchPieChartData(), this.fetchDoorStateChartData()])\n      .then(([xyResponse, pieResponse, doorStateResponse]) => {\n        this.createXyChart(xyResponse);\n        this.createPieChart(pieResponse);\n        this.renderRanges(doorStateResponse);\n      })\n      .catch(console.error)\n      .finally(() => this.setState({ isLoading: false }));\n  }\n\n  update = () => {\n    Promise.all([this.fetchXyChartData(), this.fetchPieChartData(), this.fetchDoorStateChartData()])\n      .then(([xyResponse, pieResponse, doorStateResponse]) => {\n        this.setXyChartData(xyResponse);\n        this.setPieChartData(this.preparePieChartData(pieResponse));\n        this.renderRanges(doorStateResponse);\n      })\n      .catch(console.error);\n  }\n\n  renderRanges({data}: IDoorStateDataResponse) {\n    const { dateAxis } = this;\n    if (!dateAxis) return;\n\n    dateAxis.axisRanges.clear();\n\n    data.forEach((el: IXyChartDoorStateData) => {\n      this.createRange(dateAxis, new Date(el.startDateTime), new Date(el.endDateTime), this.rangesColors[el.state]);\n    });\n  }\n\n  setXyChartData(xyChartData: IXyChartDataItem[]) {\n    this.setState({\n      charts: { ...this.state.charts, xy: xyChartData }\n    });\n\n    if (this.xyChart) this.xyChart.data = xyChartData;\n  }\n\n  setPieChartData(pieChartData: IPieChartItem[]) {\n    this.setState({\n      charts: { ...this.state.charts, pie: pieChartData }\n    });\n\n    if (this.pieChart) this.pieChart.data = pieChartData;\n  }\n\n  preparePieChartData({openTime, closedTime}: IDoorStateStatisticResponse): IPieChartItem[] {\n    const [openedHours, openedMinutes] = this.splitTime(openTime);\n    const [closedHours, closedMinutes] = this.splitTime(closedTime);\n\n    const noData = parseInt(openTime) === 0 && parseInt(closedTime) === 0; // BE response \"00:00:00\"\n\n    return noData\n      ? []\n      : [\n        {state: 'Opened', amount: this.calcAmount(openedHours, openedMinutes), color: color(CFG.openedColor).lighten(0.65)},\n        {state: 'Closed', amount: this.calcAmount(closedHours, closedMinutes), color: color(CFG.closedColor).lighten(0.65)}\n      ];\n  }\n\n  splitTime(s: string): [string, string] {\n    const splitedOpen = s.split(':');\n    const [openHours, openMinutes] = splitedOpen; // ignoring seconds for now\n    return [openHours, openMinutes];\n  }\n\n  calcAmount(openedHours: string, openedMinutes: string): number {\n    return (parseInt(openedHours) * 60) + parseInt(openedMinutes);\n  }\n\n  fetchXyChartData(): Promise<IXyChartDataItem[]> {\n    return fetchRoomTemperature({ id: this.state.location, ...this.state.datepicker })\n      .then(({ data = [] }) => data.map((el: IXyChartDataItem) => ({\n        temperature: el.temperature,\n        timestamp: new Date(el.timestamp)\n      })));\n  }\n\n  fetchPieChartData(): Promise<IDoorStateStatisticResponse> {\n    return fetchRoomStatistic({ id: this.state.location, ...this.state.datepicker });\n  }\n\n  fetchDoorStateChartData(): Promise<IDoorStateDataResponse> {\n    return fetchDoorStateData({ id: this.state.location, ...this.state.datepicker });\n  }\n\n  createRange(axis: DateAxis<AxisRenderer>, from: Date, to: Date, color: Color) {\n    const range = axis.axisRanges.create();\n    (range as any).value = from;\n    (range as any).endValue = to;\n    range.axisFill.fill = color;\n    range.axisFill.fillOpacity = 0.3;\n  }\n\n  createXyChart(chartData: IXyChartDataItem[]) {\n    this.xyChart = create(CFG.chartId, XYChart);\n    this.xyChart.cursor = new XYCursor();\n    this.setXyChartData(chartData);\n\n    this.dateAxis = this.xyChart.xAxes.push(new DateAxis());\n    this.dateAxis.title.text = \"üïë Time\";\n    this.dateAxis.tooltipDateFormat = \"dd.MM\";\n    this.dateAxis.dateFormats.setKey(\"hour\", \"MMMM dt\");\n    this.dateAxis.periodChangeDateFormats.setKey(\"hour\", \"MMMM dt\");\n    this.dateAxis.startLocation = 1;\n    this.dateAxis.endLocation = 0;\n\n    const valueAxis = this.xyChart.yAxes.push(new ValueAxis());\n    valueAxis.title.text = \"üå° (¬∞C)\";\n\n    const series = this.xyChart.series.push(new LineSeries());\n    series.dataFields.valueY = \"temperature\";\n    series.dataFields.dateX = \"timestamp\";\n    series.name = \"Temperature\";\n    series.stroke = color('yellow').lighten(0.1);\n    series.fill = color('#efefef');\n    series.strokeWidth = 1;\n    // series.strokeOpacity = 0.8;\n    // series.fillOpacity = 0.5;\n    // series.tensionY = 0.97;\n    // series.tensionX = 0.97;\n    series.tooltipText = \"At {dateX.formatDate('HH:mm')} the temperature was {valueY}¬∞\";\n\n    const scrollbarX = new XYChartScrollbar(); // Add horizotal scrollbar with preview\n    scrollbarX.series.push(series);\n    this.xyChart.scrollbarX = scrollbarX;\n  }\n\n  createPieChart({ openTime, closedTime }: IDoorStateStatisticResponse) {\n    this.pieChart = create(CFG.chartPieId, PieChart);\n\n    const pieSeries = this.pieChart.series.push(new PieSeries());\n    pieSeries.slices.template.propertyFields.fill = \"color\";\n    pieSeries.slices.template.propertyFields.stroke = \"color\";\n    pieSeries.dataFields.value = \"amount\";\n    pieSeries.dataFields.category = \"state\";\n    pieSeries.slices.template.tooltipText = \"{category}: {value.value} minutes\";\n\n    this.setPieChartData(this.preparePieChartData({ openTime, closedTime }));\n  }\n\n  datepickerChanged = (field: keyof RoomDetailsState['datepicker'], value: string) => {\n    this.setState({\n      datepicker: {\n        ...this.state.datepicker,\n        [field]: value\n      }\n    });\n  }\n\n  formatDate(date: Date, chunk: 0 | 1 = 0): string {\n    return date.toISOString().split('T')[chunk];\n  }\n\n  render(): JSX.Element {\n    const { location, isLoading, datepicker, charts } = this.state;\n\n    return (\n      <div className=\"container\">\n        <div className=\"row mb-5\">\n          <div className=\"col-12\">\n            <div className=\"row mb-3 mt-3\">\n              <div className=\"col-3\">\n                <Link to=\"/\" className=\"text-decoration-none\">\n                  <button type=\"button\" className=\"btn btn-light alert btn-block\">\n                    <span role=\"img\" aria-label=\"go back\">‚Üê</span> select room\n                  </button>\n                </Link>\n              </div>\n              <div className=\"col-9\">\n                <div className=\"alert alert-success text-center\">\n                  {location}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"row\">\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Date From</label>\n                  <input\n                    type=\"date\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('dateFrom', value)}\n                    value={datepicker.dateFrom} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Time From</label>\n                  <input\n                    type=\"time\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('timeFrom', value)}\n                    value={datepicker.timeFrom} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Date To</label>\n                  <input\n                    type=\"date\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('dateTo', value)}\n                    value={datepicker.dateTo} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <div className=\"form-group\">\n                  <label>Time To</label>\n                  <input\n                    type=\"time\"\n                    className=\"form-control\"\n                    onChange={({ target: { value } }) => this.datepickerChanged('timeTo', value)}\n                    value={datepicker.timeTo} />\n                </div>\n              </div>\n\n              <div className=\"col\">\n                <label>&nbsp;</label>\n                <button onClick={this.update} type=\"button\" className=\"form-control btn btn-outline-primary\">\n                  <span role=\"img\" aria-label=\"go back\">üîÑ</span>\n                </button>\n              </div>\n            </div>\n\n            {/* TODO: info message about timings */}\n\n            <div className=\"alert alert-warning d-flex justify-content-around align-items-center\">\n              <div className=\"d-flex align-items-center\">\n                <div className=\"rounded-circle mr-2\" style={{ width: '1rem', height: '1rem', backgroundColor: CFG.openedColor }}></div>\n                <div>Door Opened</div>\n              </div>\n              <div>Temperature</div>\n              <div className=\"d-flex align-items-center\">\n                <div className=\"rounded-circle mr-2\" style={{ width: '1rem', height: '1rem', backgroundColor: CFG.closedColor }}></div>\n                <div>Door Closed</div>\n              </div>\n            </div>\n\n            <div id={CFG.chartId} style={{\n              width: \"100%\",\n              height: \"25rem\",\n              display: charts.xy.length === 0 ? 'none' : 'block'\n            }}>\n            </div>\n\n            {(charts.xy.length === 0 && !isLoading) && <NoData />}\n\n            <div className=\"alert alert-secondary text-center\">Proximity</div>\n            <div id={CFG.chartPieId} className=\"mt-5\" style={{\n              width: \"100%\",\n              height: \"10rem\",\n              display: charts.pie.length === 0 ? 'none' : 'block'\n            }}>\n            </div>\n\n            {(charts.pie.length === 0 && !isLoading) && <NoData />}\n\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n\nexport default RoomDetails;\n","import React, { useState } from 'react';\n\ninterface RoomSearchProps {\n  onChange: (searchTerm: string) => void;\n}\n\nexport const RoomSearch = ({onChange}: RoomSearchProps): JSX.Element => {\n  const [searchTerm, setSearchTerm] = useState<string>('');\n\n  const searchTermChanged = (searchTerm: string) => {\n    setSearchTerm(searchTerm);\n    onChange(searchTerm);\n  }\n\n  return (\n    <div className=\"form-group\">\n      <input\n        type=\"text\"\n        className=\"form-control\"\n        value={searchTerm}\n        placeholder=\"Search for a room..\"\n        onChange={( {target: {value: searchTerm} }) => searchTermChanged(searchTerm) } />\n    </div>\n  );\n}\n","import * as React from 'react';\n\nimport { Link } from \"react-router-dom\";\nimport { fetchRooms } from './RoomApi.service';\nimport { RoomSearch } from './Search';\n\ninterface RoomListProps {}\n\ninterface RoomListState {\n  initialRooms: string[];\n  rooms: string[];\n}\n\nclass RoomList extends React.Component<RoomListProps, RoomListState> {\n  constructor(props: RoomListProps) {\n    super(props);\n\n    this.state = {\n      initialRooms: [],\n      rooms: []\n    };\n  }\n\n  componentWillMount() {\n    const rooms = sessionStorage.getItem('rooms');\n\n    if (rooms) {\n      this.setRooms(JSON.parse(rooms));\n    } else {\n      fetchRooms().then(initialRooms => {\n        this.setRooms(initialRooms);\n        this.cacheRooms(initialRooms);\n      });\n    }\n  }\n\n  setRooms(initialRooms: string[]) {\n    this.setState({\n      initialRooms,\n      rooms: [...initialRooms]\n    });\n  }\n\n  cacheRooms(initialRooms: string[]) {\n    sessionStorage.setItem('rooms', JSON.stringify(initialRooms));\n  }\n\n  filterRooms = (searchTerm: string) => {\n    const { initialRooms } = this.state;\n    const termLowerCased = searchTerm.toLowerCase();\n\n    const rooms = searchTerm\n      ? initialRooms.filter(r => r.toLowerCase().indexOf(termLowerCased) > -1)\n      : initialRooms;\n\n    this.setState({rooms});\n  }\n\n  render(): JSX.Element {\n    return (\n      <div className=\"container mt-4\">\n        <div className=\"row\">\n          <div className=\"col-6 offset-3\">\n            <RoomSearch onChange={this.filterRooms} />\n          </div>\n        </div>\n\n        <div className=\"row\">\n          <div className=\"col-6 offset-3\">\n            <div className=\"list-group mb-5\">\n            {this.state.rooms.map((room: string) =>\n              <Link\n                to={`/room/${room}`}\n                key={room}\n                className=\"list-group-item list-group-item-action\">\n                {room}\n              </Link>\n            )}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default RoomList;\n","import React from 'react';\n\nimport './App.css';\n\nimport RoomDetails from './room/Details';\nimport RoomList from './room/List';\n\nimport { HashRouter as Router, Route } from \"react-router-dom\";\n\nfunction App() {\n  return (\n    <Router basename={process.env.NODE_ENV === 'development' ? '' : '/itera-smart-building/'}>\n      <Route exact path=\"/\" component={RoomList} />\n      <Route path=\"/room/:id\" component={RoomDetails} />\n    </Router>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}